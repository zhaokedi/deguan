<extend name="Public/base" />

<block name="body">
    <!-- 标题栏 -->
    <div class="main-title">
        <h2>平台统计列表</h2>
    </div>
    <div class="cf" style="padding: 10px 3px 10px 3px;background-color: #f4f4f4;width: 100%;font-size: 20px">
       日期： {$time_start}至{$time_end} 地区：{$addr.province}{$addr.city}{$addr.state}
    </div>

    <div class="cf">


        <!-- 高级搜索 -->
        <div class="search-form fr cf">
            <div class="sleft">
                <!--div class="drop-down" style="width: 85px;">
                    <span id="sch-sort-txt" class="sort-txt" data="{$status}" style="width:60px;"><if condition="get_withdrawstatus_title($status) eq ''">所有<else/>{:get_withdrawstatus_title($status)}</if></span>
                    <i class="arrow arrow-down"></i>
                    <ul id="sub-sch-menu" class="nav-list hidden">
                        <li><a href="javascript:;" value="">所有</a></li>
                        <volist name="Think.config.WITHDRAW_STATUS" id="vo">
                            <li><a href="javascript:;" value="{$key}">{$vo}</a></li>
                        </volist>
                    </ul>
                </div-->

                <a class="sch-btn" href="javascript:;" id="search" url="{:U('')}">搜 索</a>
            </div>
            <div class="btn-group-click adv-sch-pannel fl">
                <button class="btn">高 级<i class="btn-arrowdown"></i></button>
                <div class="dropdown cf">
                    <div class="row">
                        <label>创建时间：</label>
                        <input type="text" id="time-start" name="time-start" class="text input-2x" value="{$time_start}" placeholder="起始时间" /> -
                        <div class="input-append date" id="datetimepicker"  style="display:inline-block">
                            <input type="text" id="time-end" name="time-end" class="text input-2x" value="{$time_end}" placeholder="结束时间" />
                            <span class="add-on"><i class="icon-th"></i></span>
                        </div>
                    </div>
                    <if condition="$Think.session.isagent eq 0">
                        <div class="row" style="display: block;">
                            <label>地区筛选：</label>
                            <div id="city" style="display: inline-block;">
                                <input type="hidden" name="province" value="{$Think.get.province}">
                                <input type="hidden" name="city" value="{$Think.get.city}">
                                <input type="hidden" name="state" value="{$Think.get.state}">
                                <select class="prov" ></select>
                                <select class="city"  disabled="disabled"></select>
                                <select class="dist"  disabled="disabled"></select>
                            </div>
                        </div>
                    </if>
                </div>
                <a  href="javascript:;" class="btn"  onclick="print_data()"  >打印</a>
            </div>
        </div>
    </div>
    <!-- 数据列表 -->
    <div class="data-table table-striped">
    <table class="">
    <thead>
        <tr>
       
        <th class="">名称</th>
        <th class="">统计</th>
    
        </tr>
    </thead>
    <tbody id="courseshow">
        <tr>
            <td>总用户</td>
            <td>{$rewardInfo.totaluser|default=0}</td>
        </tr>

        <tr>
            <td>分享人数</td>
            <td>{$totaluser|default=0}</td>
        </tr>
        <tr>
        <td>分享红包总计</td>
        <td>{$rewardInfo.code1|default=0}</td>
        </tr>
        <tr>
            <td>平台总充值</td>
            <td>{$total|default=0}</td>
        </tr>
       <tr>
            <td>平台总提现</td>
            <td>{$txtotal|default=0}</td>
        </tr>
       <!--<tr>-->
            <!--<td>平台二级分享的人数</td>-->
            <!--<td>{$fxtotal|default=0}</td>-->
        <!--</tr>-->

        <!--<tr>-->
            <!--<td>总公司收益</td>-->
            <!--<td>{$rewardInfo.code2|default=0}</td>-->
        <!--</tr>-->
       
         <!--<tr>-->
            <!--<td>代理商奖励</td>-->
            <!--<td>{$rewardInfo.code3|default=0}</td>-->
        <!--</tr>-->

        <tr>
            <td>会员总数</td>
            <td>{$rewardInfo.totallevel|default=0}</td>
        </tr>
        <tr>
            <td>
            <a class="foldst" title="2">+</a>
            一心会员数</td>
            <td>{$rewardInfo.totallevel1|default=0}</td>
        </tr>
        <tr name="2" class="hide">
            <td>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;学生</td>
            <td>{$rewardInfo.totallevel1_s|default=0}</td>
        </tr>
        <tr name="2" class="hide" >
            <td>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;教师</td>
            <td>{$rewardInfo.totallevel1_t|default=0}</td>
        </tr>
        <tr>
            <td>
            <a class="foldst" title="3">+</a>
            二心会员数</td>
            <td>{$rewardInfo.totallevel2|default=0}</td>
        </tr>
        <tr name="3" class="hide">
            <td>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;学生</td>
            <td>{$rewardInfo.totallevel2_s|default=0}</td>
        </tr>
        <tr name="3" class="hide" >
            <td>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;教师</td>
            <td>{$rewardInfo.totallevel2_t|default=0}</td>
        </tr>
        <!--<tr>-->
            <!--<td>三心会员数</td>-->
            <!--<td>{$rewardInfo.totallevel3|default=0}</td>-->
        <!--</tr>-->
        <!--<tr>-->
            <!--<td>四心会员数</td>-->
            <!--<td>{$rewardInfo.totallevel4|default=0}</td>-->
        <!--</tr>-->
        <tr>
            <td>会员推广奖励总计</td>
            <td>{$rewardInfo.level_award|default=0}</td>
        </tr>
          <!--<tr>-->
            <!--<td>用户一级推荐人奖励</td>-->
            <!--<td>{$rewardInfo.code5|default=0}</td>-->
        <!--</tr>-->
        <!---->
          <!--<tr>-->
            <!--<td>用户二级推荐人奖励</td>-->
            <!--<td>{$rewardInfo.code6|default=0}</td>-->
        <!--</tr>-->
        <tr>
            <td>
                <!--<a class="foldst" title="1">+</a>-->
                订单总金额</td>
            <td>{$rewardInfo.code10|default=0}</td>
        </tr>
        <!--<tr name="1" class="hide">-->
            <!--<td>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;非会员</td>-->
            <!--<td>{$rewardInfo.code10|default=0}</td>-->
        <!--</tr>-->
        <!--<tr name="1" class="hide" >-->
            <!--<td>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;会员</td>-->
            <!--<td>{$rewardInfo.code10|default=0}</td>-->
        <!--</tr>-->
        <tr>
            <td>间接奖励总计</td>
            <td>{$rewardInfo.code100|default=0}</td>
        </tr>
        <tr>
            <td>课时券总发放</td>
            <td>{$rewardInfo.code7|default=0}</td>
        </tr>
        <tr>
            <td>课时券总抵用</td>
            <td>{$rewardInfo.code77|default=0}</td>
        </tr>
        <tr>
            <td>代金券总发放 </td>
            <td>{$rewardInfo.code8|default=0}</td>
        </tr>
        <tr>
            <td>代金券总抵用 </td>
            <td>{$rewardInfo.code88|default=0}</td>
        </tr>
        <tr>
            <td>精推人数总计</td>
            <td>{$rewardInfo.jt_count|default=0}</td>
        </tr>
        <tr>
            <td>精推奖励总计 </td>
            <td>{$rewardInfo.jt_award|default=0}</td>
        </tr>
        <tr>
            <td>会员费总计 </td>
            <td>{$rewardInfo.vip_fee|default=0}</td>
        </tr>
        <tr>
            <td>信息服务费总计 </td>
            <td>{$rewardInfo.service_fee|default=0}</td>
        </tr>
        <tr>
            <td>资金解冻手续费 </td>
            <td>{$rewardInfo.unbrozen_fee|default=0}</td>
        </tr>

    </tbody>
    </table>
    </div>
 
</block>

<block name="script">
    <link href="__STATIC__/datetimepicker/css/datetimepicker.css" rel="stylesheet" type="text/css">
    <php>if(C('COLOR_STYLE')=='blue_color') echo '<link href="__STATIC__/datetimepicker/css/datetimepicker_blue.css" rel="stylesheet" type="text/css">';</php>
    <link href="__STATIC__/datetimepicker/css/dropdown.css" rel="stylesheet" type="text/css">
    <script type="text/javascript" src="__STATIC__/datetimepicker/js/bootstrap-datetimepicker.min.js"></script>
    <script type="text/javascript" src="__STATIC__/datetimepicker/js/locales/bootstrap-datetimepicker.zh-CN.js" charset="UTF-8"></script>
    <script type="text/javascript" src="__STATIC__/cityselect/jquery.cityselect.js" charset="UTF-8"></script>

    <script type="text/javascript">
  //搜索功能
    $("#search").click(function(){
        var url = $(this).attr('url');
        //var is_dealed = $("#sch-sort-txt").attr("data");
        var query  = $('.search-form').find('input').serialize();
        query = query.replace(/(&|^)(\w*?\d*?\-*?_*?)*?=?((?=&)|(?=$))/g,'');
        query = query.replace(/^&/g,'');
        
        if( url.indexOf('?')>0 ){
            url += '&' + query;
        }else{
            url += '?' + query;
        }
        var agent={$Think.session.isagent};
        if(agent==0){
            var province = $(".prov").get(0).value;
            var city = $(".city").get(0).value;
            var state = $(".dist").get(0).value;
            if (province != '') {
                url += '&' + 'province=' + province;
            }
            if (city != '') {
                url += '&' + 'city=' + city;
            }
            if (state != '') {
                url += '&' + 'state=' + state;
            }
        }
        window.location.href = url;
    });
    function print_data(){
        print();
    }
    /* 状态搜索子菜单 */
    $(".search-form").find(".drop-down").hover(function(){
        $("#sub-sch-menu").removeClass("hidden");
    },function(){
        $("#sub-sch-menu").addClass("hidden");
    });
    $("#sub-sch-menu li").find("a").each(function(){
        $(this).click(function(){
            var text = $(this).text();
            $("#sch-sort-txt").text(text).attr("data",$(this).attr("value"));
            $("#sub-sch-menu").addClass("hidden");
        })
    });

    //回车自动提交
    $('.search-form').find('input').keyup(function(event){
        if(event.keyCode===13){
            $("#search").click();
        }
    });

    $('#time-start').datetimepicker({
        format: 'yyyy-mm-dd hh:ii',
        language:"zh-CN",
        minView:0,
        minuteStep:1,

        autoclose:true
    });

    $('#datetimepicker').datetimepicker({
       format: 'yyyy-mm-dd hh:ii',
        language:"zh-CN",
        minView:0,
        autoclose:true,
        minuteStep:1,
        pickerPosition:'bottom-left'
    })

        $(".hide").css('display','none');
        $("#courseshow").find("[name=0]").slideDown("slow");
        $('.foldst').click(function(){
            var htmlCon=$(this).text();
            var cid=$(this).attr('title');
            if(htmlCon=='-'){
                foldfunc(cid);
                $(this).html('+');


            }else{
                $(this).html('-');
                $("#courseshow").find("[name="+cid+"]").slideDown("slow");
            }

        });

        function foldfunc(cid){
            var foldObj= $("#courseshow").find("[name="+cid+"]");

            foldObj.slideUp("slow");
            var sonObj=$(foldObj).children().eq(0).children().eq(0);
            $(sonObj).html('+');
            var sonCid=$(sonObj).attr('title');
            if(sonCid != undefined){
                foldfunc(sonCid);
            }
        }
  $(function(){

      $("#city").citySelect({
          url:"__STATIC__/cityselect/city.min.js",
          nodata:"none",
          prov:<notempty name="province">"{$province|default='null'}"<else/>null</notempty>,
          city:<notempty name="city">"{$city|default='null'}"<else/>null</notempty>,
          dist:<notempty name="state">"{$state|default='null'}"<else/>null</notempty>,
          required:false
  });

  });
    </script>
</block>
